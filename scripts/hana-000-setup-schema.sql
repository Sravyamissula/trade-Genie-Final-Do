-- SAP HANA Schema Setup for Trade Intelligence
-- Note: In SAP HANA Cloud, schemas are typically created automatically when you create tables
-- This script creates the core tables for the trade intelligence system

-- Create Trade Risk Analytics Table
CREATE TABLE TRADE_RISK_ANALYTICS (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    COUNTRY_CODE NVARCHAR(3) NOT NULL,
    COUNTRY_NAME NVARCHAR(100) NOT NULL,
    RISK_SCORE DECIMAL(5,2) NOT NULL,
    POLITICAL_RISK DECIMAL(5,2) NOT NULL,
    ECONOMIC_RISK DECIMAL(5,2) NOT NULL,
    CURRENCY_RISK DECIMAL(5,2) NOT NULL,
    TRADE_VOLUME BIGINT DEFAULT 0,
    LAST_UPDATED TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    RISK_FACTORS NCLOB,
    RECOMMENDATIONS NCLOB
);

-- Create Market Intelligence Table
CREATE TABLE MARKET_INTELLIGENCE (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    COUNTRY_CODE NVARCHAR(3) NOT NULL,
    PRODUCT_CODE NVARCHAR(20) NOT NULL,
    PRODUCT_NAME NVARCHAR(200) NOT NULL,
    TARIFF_RATE DECIMAL(8,4) NOT NULL,
    TRADE_VOLUME BIGINT DEFAULT 0,
    MARKET_SHARE DECIMAL(5,2) DEFAULT 0,
    GROWTH_RATE DECIMAL(5,2) DEFAULT 0,
    LAST_UPDATED TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    MARKET_TRENDS NCLOB,
    COMPETITIVE_ANALYSIS NCLOB
);

-- Create Tariff Data Table
CREATE TABLE TARIFF_DATA (
    ID BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
    HS_CODE NVARCHAR(20) NOT NULL,
    PRODUCT_DESCRIPTION NVARCHAR(500) NOT NULL,
    ORIGIN_COUNTRY NVARCHAR(3) NOT NULL,
    DESTINATION_COUNTRY NVARCHAR(3) NOT NULL,
    TARIFF_RATE DECIMAL(8,4) NOT NULL,
    TARIFF_TYPE NVARCHAR(50) DEFAULT 'AD_VALOREM',
    EFFECTIVE_DATE DATE NOT NULL,
    EXPIRY_DATE DATE,
    LAST_UPDATED TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    ADDITIONAL_DUTIES NCLOB,
    TRADE_AGREEMENTS NVARCHAR(200)
);

-- Create Supporting Countries Table
CREATE TABLE COUNTRIES (
    CODE NVARCHAR(3) PRIMARY KEY,
    NAME NVARCHAR(100) NOT NULL,
    REGION NVARCHAR(50),
    CURRENCY NVARCHAR(3),
    TRADE_BLOC NVARCHAR(100),
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Create Supporting Products Table
CREATE TABLE PRODUCTS (
    HS_CODE NVARCHAR(20) PRIMARY KEY,
    DESCRIPTION NVARCHAR(500) NOT NULL,
    CATEGORY NVARCHAR(100),
    UNIT_OF_MEASURE NVARCHAR(20),
    CREATED_AT TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Create indexes for better performance
CREATE INDEX IDX_TRADE_RISK_COUNTRY ON TRADE_RISK_ANALYTICS(COUNTRY_CODE);
CREATE INDEX IDX_MARKET_INTEL_COUNTRY_PRODUCT ON MARKET_INTELLIGENCE(COUNTRY_CODE, PRODUCT_CODE);
CREATE INDEX IDX_TARIFF_HS_COUNTRIES ON TARIFF_DATA(HS_CODE, ORIGIN_COUNTRY, DESTINATION_COUNTRY);
CREATE INDEX IDX_TARIFF_EFFECTIVE_DATE ON TARIFF_DATA(EFFECTIVE_DATE);
